language: node_js
node_js:
  - "stable"
cache:
  directories:
    - "node_modules"
after_success:
- npm run coverage
addons:
    code_climate:
        repo_token: fd3130be92f9be2ea93a77a660cb01cdea96c10c95c2971f790f7a0376604d30
script: istanbul cover node_modules/mocha/bin/_mocha -- -R spec
before_script:
  - npm install codeclimate-test-reporter istanbul -g
after_script:
  - codeclimate-test-reporter < ./coverage/lcov.info
after_script: NODE_ENV=test istanbul cover ./node_modules/mocha/bin/_mocha --report lcovonly -- -R spec && cat ./coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js && rm -rf ./coverage
